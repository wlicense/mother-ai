# マザーAI - E2Eテスト仕様書

## 概要

本ドキュメントは、マザーAIの全ページにおけるE2Eテスト項目を定義します。

**生成日**: 2025年11月6日
**バージョン**: 1.0
**テストフレームワーク**: Playwright

---

## P-003: ログインページ

### 正常系テスト

#### TC-L001: メール/パスワードログイン成功
**前提条件**
- 承認済みユーザーアカウントが存在する

**テスト手順**
1. ログインページ (`/login`) にアクセス
2. メールアドレス入力: `test@example.com`
3. パスワード入力: `TestPassword123`
4. 「ログイン」ボタンをクリック

**期待結果**
- `/projects` ページにリダイレクト
- JWTトークンがlocalStorageに保存される
- ユーザー名が表示される

#### TC-L002: Google OAuthログイン
**テスト手順**
1. ログインページにアクセス
2. 「Googleでログイン」ボタンをクリック
3. Googleログインフローを完了

**期待結果**
- OAuth認証成功
- `/projects` ページにリダイレクト

#### TC-L003: GitHub OAuthログイン
**テスト手順**
1. ログインページにアクセス
2. 「GitHubでログイン」ボタンをクリック
3. GitHubログインフローを完了

**期待結果**
- OAuth認証成功
- `/projects` ページにリダイレクト

### 異常系テスト

#### TC-L101: 誤ったパスワードでログイン試行
**テスト手順**
1. ログインページにアクセス
2. メールアドレス入力: `test@example.com`
3. パスワード入力: `WrongPassword`
4. 「ログイン」ボタンをクリック

**期待結果**
- エラーメッセージ表示: 「メールアドレスまたはパスワードが正しくありません」
- ログインページに留まる

#### TC-L102: 存在しないメールアドレスでログイン試行
**テスト手順**
1. メールアドレス入力: `nonexistent@example.com`
2. パスワード入力: `anypassword`
3. 「ログイン」ボタンをクリック

**期待結果**
- エラーメッセージ表示

#### TC-L103: 審査中ユーザーのログイン試行
**テスト手順**
1. ステータスが`pending`のユーザーでログイン

**期待結果**
- `/pending` ページにリダイレクト
- 「審査中です」メッセージ表示

#### TC-L104: 停止中ユーザーのログイン試行
**テスト手順**
1. ステータスが`suspended`のユーザーでログイン

**期待結果**
- エラーメッセージ表示: 「アカウント停止中」

### UIテスト

#### TC-L201: レスポンシブデザイン検証
**テスト手順**
1. デスクトップ (1920x1080) で表示
2. タブレット (768x1024) で表示
3. モバイル (375x667) で表示

**期待結果**
- 全デバイスで正しくレイアウト表示
- モバイルでタップ可能なボタンサイズ

#### TC-L202: バリデーション表示
**テスト手順**
1. メールアドレスに無効な値を入力 (`invalid-email`)
2. フォーム送信試行

**期待結果**
- ブラウザのHTML5バリデーション表示

---

## P-002: 申請フォーム

### 正常系テスト

#### TC-A001: 申請フォーム送信成功
**テスト手順**
1. `/apply` にアクセス
2. 全必須項目を入力
3. 「申請を送信」ボタンをクリック

**期待結果**
- `/pending` ページにリダイレクト
- 申請完了メッセージ表示

### 異常系テスト

#### TC-A101: 利用目的が短すぎる
**テスト手順**
1. 利用目的に30文字未満を入力
2. 送信試行

**期待結果**
- エラーメッセージ表示: 「50文字以上で記入してください」

#### TC-A102: パスワード不一致
**テスト手順**
1. パスワード: `password123`
2. パスワード確認: `differentpassword`
3. 送信試行

**期待結果**
- エラーメッセージ: 「パスワードが一致しません」

---

## P-004: プロジェクト一覧

### 正常系テスト

#### TC-P001: プロジェクト一覧表示
**前提条件**
- ログイン済み
- 3つのプロジェクトが存在

**テスト手順**
1. `/projects` にアクセス

**期待結果**
- 3つのプロジェクトカードが表示される
- 各カードに名前、進捗、Phase情報が表示

#### TC-P002: 新規プロジェクト作成
**テスト手順**
1. 「新規プロジェクト作成」ボタンをクリック
2. プロジェクト名入力: 「テストプロジェクト」
3. 作成ボタンをクリック

**期待結果**
- プロジェクトが作成される
- `/projects/{id}` にリダイレクト

---

## P-005: AI対話・プロジェクト開発

### 正常系テスト

#### TC-D001: Phaseカード表示
**テスト手順**
1. `/projects/{id}` にアクセス

**期待結果**
- 4つのPhaseカードが表示
- Phase 1のみ有効（他はロック状態）

#### TC-D002: メッセージ送信
**テスト手順**
1. メッセージ入力: 「こんにちは」
2. 送信ボタンをクリック

**期待結果**
- ユーザーメッセージが表示
- AI応答がストリーミング表示

---

## セキュリティテスト

### TC-S001: 未認証アクセス防止
**テスト手順**
1. ログアウト状態で `/projects` にアクセス

**期待結果**
- `/login` にリダイレクト

### TC-S002: XSS対策
**テスト手順**
1. メッセージに `<script>alert('XSS')</script>` を入力

**期待結果**
- スクリプトはエスケープされ、そのまま表示

### TC-S003: CSRF対策
**テスト手順**
1. 外部サイトから認証済みAPIへPOSTリクエスト

**期待結果**
- リクエスト拒否

---

## パフォーマンステスト

### TC-PERF001: ページ読み込み速度
**期待値**
- 初回ロード: 2秒以内
- 2回目以降: 1秒以内

### TC-PERF002: API応答速度
**期待値**
- プロジェクト一覧取得: 500ms以内
- メッセージ送信: 100ms以内（ストリーミング開始まで）

---

## テスト実行コマンド

```bash
# 全テスト実行
npm run test:e2e

# 特定ページのみ
npm run test:e2e -- --grep "P-003"

# ヘッドレスモードで実行
npm run test:e2e:headless

# スクリーンショット比較
npm run test:visual
```

---

**更新履歴**
- 2025-11-06: 初版作成
